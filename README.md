# Тестовое задание HQ
Проект Проект представляет собой площадку для размещения онлайн-курсов с набором уроков. Доступ к урокам предоставляется после покупки курса (подписки). Внутри курса студенты автоматически распределяются по группам.
## Выполнены следующие задания:
### 1. Создать сущность продукта. У продукта должен быть создатель этого продукта(автор/преподаватель). Название продукта, дата и время старта, стоимость.
Добавлено поле стоимости в модель курса
### 2. Определить, каким образом мы будем понимать, что у пользователя(клиент/студент) есть доступ к продукту.
Создана модель Subscription со связями с юзером и курсом.
### 3. Создать сущность урока. Урок может принадлежать только одному продукту. В уроке должна быть базовая информация: название, ссылка на видео.
Поправлена модель урока, добавлено поле внешнего ключа в модели курса
### 4. Создать сущность баланса пользователя. Баланс пользователя не может быть ниже 0, баланс пользователя при создании пользователя равен 1000 бонусов. Бонусы могут начислять только через админку или посредством REST-апи с правами is_staff=True.
Модель баланса создана, в ней связь по внешнему ключу на юзера и числовое значение. На числовое значение назначен валидатор, исключающий возможность отрицательных чисел. Добавлен диспетчер сигнала пост-сэйв для модели юзера, в нем юзеру создается баланс и зачисляется 1000 бонусов. Протестировано вручную, работает. Так же добавлено action balance в вьюху для юзеров, по нему можно добавлять бонусы любому юзеру. Протестировано вручную.
### 5. Реализовать API на список продуктов, доступных для покупки(доступных к покупке = они еще не куплены пользователем и у них есть флаг доступности), которое бы включало в себя основную информацию о продукте и количество уроков, которые принадлежат продукту.
Сделаны пермишены, поправлены сериалайзеры для курсов (там теперь вся статистика включена), настроен метод get_queryset для вьюхи CourseViewSet. Проверено вручную, работает как ожидается. Подписанные курсы из списка выпадают
### 6. Реализовать API оплаты продукты за бонусы. Назовем его …/pay/ 
Добавлен как action в CourseViewSet. Сделана валидация на недостаток бонусов и прочие неприятности. С баланса списывается сумма, все работает как надо.
### 7. По факту оплаты и списания бонусов с баланса пользователя должен быть открыт доступ к курсу.
Это делается в предыдущем пункте, создается подписка на курс
### 8. После того, как доступ к курсу открыт, пользователя необходимо равномерно распределить в одну из 10 групп студентов. (4 балла) 
Добавлен диспетчер сигнала пост-сэйв модели Subscription и в нем происходит магия. Распределительная шляпа кидает студента в одну из групп. Если групп нет, создаст тут же
### Дополнительная статистика включена в сериалайзер курсов
Все тесты проводились вручную в терминале или в постмане.
![2024-08-18_19-03-29](https://github.com/user-attachments/assets/1d1c599a-c6ed-450b-83ca-f5c52c4c0404)
![2024-08-18_19-10-29](https://github.com/user-attachments/assets/f54438ad-9127-4dee-81d9-8ff03b437a4b)
![2024-08-18_19-11-39](https://github.com/user-attachments/assets/4b1f1701-8ea7-4fb1-b501-743d3c2e4361)
![2024-08-18_19-13-14](https://github.com/user-attachments/assets/51db20ab-d9dc-4ff5-8707-665e723ca16a)
